var f=Object.defineProperty;var b=(i,e,n)=>e in i?f(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var w=(i,e,n)=>b(i,typeof e!="symbol"?e+"":e,n);class m extends Error{constructor(n,d,s){super(n);w(this,"code");w(this,"data");this.name="SignTxnsError",this.code=d,this.data=s}}var E;(function(i){i[i.UNKNOWN=-1]="UNKNOWN",i[i.AUTH=1]="AUTH"})(E||(E={}));class h extends Error{constructor(n,d,s){super(n);w(this,"code");w(this,"data");this.name="SignDataError",this.code=d,this.data=s}}const v=100+window.screenX,p=100+window.screenY,g=`width=500,height=750,left=${v},top=${p}`,u="https://lute.app",L="kiaoohollfkjhikdifohdckeidckokjh";class N{constructor(e){w(this,"siteName");w(this,"forceWeb",!1);this.siteName=e||document.title||"Unknown site"}connect(e){return new Promise(async(n,d)=>{const s=this.forceWeb?!1:window.lute;let r;s?window.dispatchEvent(new CustomEvent("lute-connect",{detail:{action:"connect",genesisID:e}})):r=open(`${u}/connect`,this.siteName,g);const o=s?"connect-response":"message";window.addEventListener(o,a);function a(c){if(!s&&c.origin!==u)return;const t=c.data||c.detail;switch(t.debug&&console.log("[Lute Debug]",t),t.action){case"ready":r==null||r.postMessage({action:"network",genesisID:e},"*");break;case"connect":window.removeEventListener(o,a),n(t.addrs);break;case"error":window.removeEventListener(o,a),d(new Error(t.message));break;case"close":window.removeEventListener(o,a),d(new Error("Operation Cancelled"));break}}})}signTxns(e){return new Promise(async(n,d)=>{const s=this.forceWeb?!1:window.lute;let r;s?window.dispatchEvent(new CustomEvent("lute-connect",{detail:{action:"sign",txns:e}})):r=open(`${u}/sign`,this.siteName,g);const o=s?"sign-txns-response":"message";window.addEventListener(o,a);function a(c){if(!s&&c.origin!==u)return;const t=c.data||c.detail;switch(t.debug&&console.log("[Lute Debug]",t),t.action){case"ready":r==null||r.postMessage({action:"sign",txns:e},"*");break;case"signed":window.removeEventListener(o,a),n(t.txns);break;case"error":window.removeEventListener(o,a),d(new m(t.message,t.code||4300));break;case"close":window.removeEventListener(o,a),d(new m("User Rejected Request",4100));break}}})}signData(e,n){return new Promise(async(d,s)=>{const r=this.forceWeb?!1:window.lute;let o;r?window.dispatchEvent(new CustomEvent("lute-connect",{detail:{action:"data",data:e,metadata:n}})):o=open(`${u}/auth`,this.siteName,g);const a=r?"sign-data-response":"message";window.addEventListener(a,c);function c(t){if(!r&&t.origin!==u)return;const l=t.data||t.detail;switch(l.debug&&console.log("[Lute Debug]",l),l.action){case"ready":o==null||o.postMessage({action:"data",data:e,metadata:n},"*");break;case"signed":window.removeEventListener(a,c),d(l.signerResponse);break;case"error":window.removeEventListener(a,c),s(new h(l.message,l.code||4300));break;case"close":window.removeEventListener(a,c),s(new h("User Rejected Request",4100));break}}})}}export{u as BASE_URL,L as EXT_ID,E as ScopeType,h as SignDataError,m as SignTxnsError,N as default};
